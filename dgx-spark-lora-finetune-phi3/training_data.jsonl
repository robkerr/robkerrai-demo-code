{"instruction": "Write a SQL query based on the following request.", "input": "Find transaction that have more than 3 products. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 3\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 10 buyer by checkout total between 2023-07-29 and 2024-01-14?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2023-07-29' AND '2024-01-14'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show purchase for the account holder with mail address 'cgposskl@demo.org' from 2023-01-14 and 2023-05-01.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'cgposskl@demo.org' AND oh.order_entry_date BETWEEN '2023-01-14' AND '2023-05-01'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the articles for any order placed by a customer with family name 'Brown' where the progress is 'paid'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Brown' AND oh.order_status = 'paid'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List order with order total above 100 and state 'on hold' between 2023-09-13 and 2023-11-07. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 100 AND oh.order_status = 'on hold' AND oh.order_entry_date BETWEEN '2023-09-13' AND '2023-11-07'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 10 client by checkout total during 2025-01-10 and 2025-07-06?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2025-01-10' AND '2025-07-06'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the buyer with contact email 'fhcgchqj@demo.org' between 2024-12-28 and 2025-02-02.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'fhcgchqj@demo.org' AND oh.order_entry_date BETWEEN '2024-12-28' AND '2025-02-02'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 5 items by revenue based on products across all sale.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 6 transaction overall. Show name, email, and how many purchase.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 6\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 2 transaction overall. Show name, email, and how many sale.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 2\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 5 transaction overall. Show name, email, and how many purchase.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 5\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Nora Martinez that include item 'SKU-0PVN9E' with at least 1 units.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Nora' AND c.SURNAME = 'Martinez' AND od.catalog_sku = 'SKU-0PVN9E' AND od.quantity >= 1\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the positions for any order placed by a account holder with family name 'Clark' where the progress is 'refunded'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Clark' AND oh.order_status = 'refunded'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List order with order total above 1000 and state 'delivered' between 2023-01-24 and 2023-04-28. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 1000 AND oh.order_status = 'delivered' AND oh.order_entry_date BETWEEN '2023-01-24' AND '2023-04-28'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Daniel Brown that include item 'SKU-KFAZZ8' with at least 10 units.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Daniel' AND c.SURNAME = 'Brown' AND od.catalog_sku = 'SKU-KFAZZ8' AND od.quantity >= 10\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every transaction that includes the item code 'SKU-XVF1T2'. Return the buyer name, the invoice number, and when it was placed on.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-XVF1T2'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the products for any order placed by a client with family name 'Robinson' where the stage is 'delivered'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Robinson' AND oh.order_status = 'delivered'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2023-06-25 and 2023-11-26.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2023-06-25' AND '2023-11-26'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 5 items by revenue based on products across all sale.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2023-12-05 and 2024-03-11.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2023-12-05' AND '2024-03-11'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 10 items by revenue based on products across all purchase.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Aiden Thompson that include item 'SKU-XPSEIM' with at least 10 quantity.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Aiden' AND c.SURNAME = 'Thompson' AND od.catalog_sku = 'SKU-XPSEIM' AND od.quantity >= 10\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show sale for the client with mail address 'sbbainhm@acme.co' from 2023-09-28 and 2024-01-08.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'sbbainhm@acme.co' AND oh.order_entry_date BETWEEN '2023-09-28' AND '2024-01-08'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the entries for any sale placed by a account holder with family name 'Thompson' where the progress is 'refunded'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Thompson' AND oh.order_status = 'refunded'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the account holder with email 'qqbsucen@mail.test' between 2025-05-14 and 2025-06-16.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'qqbsucen@mail.test' AND oh.order_entry_date BETWEEN '2025-05-14' AND '2025-06-16'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List buyer who made more than 6 order overall. Show name, contact email, and how many order.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 6\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2024-04-29 and 2024-07-10.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2024-04-29' AND '2024-07-10'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 5 sale overall. Show name, email, and how many purchase.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 5\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List customer who made more than 5 sale overall. Show name, mail address, and how many sale.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 5\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Lily Thompson that include item 'SKU-ZFK8UT' with at least 1 units.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Lily' AND c.SURNAME = 'Thompson' AND od.catalog_sku = 'SKU-ZFK8UT' AND od.quantity >= 1\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List order with cart total above 2500 and state 'processing' between 2023-04-27 and 2023-07-08. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 2500 AND oh.order_status = 'processing' AND oh.order_entry_date BETWEEN '2023-04-27' AND '2023-07-08'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show purchase for the customer with email 'bwkyopbc@acme.co' from 2024-10-09 and 2024-11-21.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'bwkyopbc@acme.co' AND oh.order_entry_date BETWEEN '2024-10-09' AND '2024-11-21'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List account holder who made more than 4 transaction overall. Show name, email, and how many order.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 4\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show new buyer who joined after 2023-07-24, include name and contact email.", "output": "SELECT FNAME, SURNAME, email\nFROM buyers\nWHERE modify_date::date > '2023-07-24';"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 5 buyer by spend between 2023-09-29 and 2024-01-26?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2023-09-29' AND '2024-01-26'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 5 person by spend between 2024-09-11 and 2025-03-16?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-09-11' AND '2025-03-16'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2023-08-01 and 2023-10-04.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2023-08-01' AND '2023-10-04'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 3 customer by checkout total during 2023-11-15 and 2024-02-22?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2023-11-15' AND '2024-02-22'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 3;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Harper Thompson that include item 'SKU-WJR64D' with at least 3 units.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Harper' AND c.SURNAME = 'Thompson' AND od.catalog_sku = 'SKU-WJR64D' AND od.quantity >= 3\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the person with contact email 'uqgtolab@mail.test' between 2023-03-15 and 2023-07-09.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'uqgtolab@mail.test' AND oh.order_entry_date BETWEEN '2023-03-15' AND '2023-07-09'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List customer who made more than 2 transaction overall. Show name, email, and how many transaction.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 2\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 3 person by amount paid during 2023-07-30 and 2023-11-27?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2023-07-30' AND '2023-11-27'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 3;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2024-04-29 and 2024-07-09.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2024-04-29' AND '2024-07-09'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show sale for the client with email 'tiyuwvgu@example.com' from 2025-02-22 and 2025-03-08.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'tiyuwvgu@example.com' AND oh.order_entry_date BETWEEN '2025-02-22' AND '2025-03-08'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every transaction that includes the item code 'SKU-35IXOK'. Return the buyer name, the reference id, and when it was transaction date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-35IXOK'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List customer who made more than 6 order overall. Show name, email, and how many transaction.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 6\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the positions for any sale placed by a customer with family name 'Johnson' where the stage is 'paid'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Johnson' AND oh.order_status = 'paid'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List buyer who made more than 6 sale overall. Show name, contact email, and how many purchase.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 6\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 10 person by checkout total during 2025-06-12 and 2025-07-12?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2025-06-12' AND '2025-07-12'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every transaction that includes the item code 'SKU-CXLL4Z'. Return the buyer name, the invoice number, and when it was order date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-CXLL4Z'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List person who made more than 4 purchase overall. Show name, email, and how many sale.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 4\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find purchase that have more than 10 positions. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 10\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List purchase with amount charged above 1000 and state 'pending' between 2024-09-14 and 2024-10-27. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 1000 AND oh.order_status = 'pending' AND oh.order_entry_date BETWEEN '2024-09-14' AND '2024-10-27'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List purchase with order total above 500 and state 'on hold' between 2025-06-23 and 2025-08-25. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 500 AND oh.order_status = 'on hold' AND oh.order_entry_date BETWEEN '2025-06-23' AND '2025-08-25'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show new buyer who joined after 2023-12-14, include name and mail address.", "output": "SELECT FNAME, SURNAME, email\nFROM buyers\nWHERE modify_date::date > '2023-12-14';"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 10 items by revenue based on line items across all purchase.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find purchase that have more than 5 products. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 5\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show purchase for the buyer with email 'gmwbkqfs@sample.io' from 2025-03-29 and 2025-05-09.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'gmwbkqfs@sample.io' AND oh.order_entry_date BETWEEN '2025-03-29' AND '2025-05-09'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 10 person by spend during 2025-08-09 and 2025-09-20?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2025-08-09' AND '2025-09-20'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show new person who joined after 2025-08-09, include name and contact email.", "output": "SELECT FNAME, SURNAME, email\nFROM buyers\nWHERE modify_date::date > '2025-08-09';"}
{"instruction": "Write a SQL query based on the following request.", "input": "List sale with amount charged above 1000 and state 'refunded' between 2025-07-02 and 2025-07-29. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 1000 AND oh.order_status = 'refunded' AND oh.order_entry_date BETWEEN '2025-07-02' AND '2025-07-29'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 3 account holder by checkout total during 2024-07-21 and 2024-12-31?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-07-21' AND '2024-12-31'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 3;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 3 customer by amount paid between 2024-08-08 and 2024-11-06?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-08-08' AND '2024-11-06'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 3;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show order for the person with mail address 'djdfkimb@sample.io' from 2025-03-08 and 2025-06-24.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'djdfkimb@sample.io' AND oh.order_entry_date BETWEEN '2025-03-08' AND '2025-06-24'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the account holder with mail address 'jtwyktop@mail.test' between 2025-09-26 and 2025-11-01.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'jtwyktop@mail.test' AND oh.order_entry_date BETWEEN '2025-09-26' AND '2025-11-01'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 5 sale overall. Show name, email, and how many order.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 5\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2023-02-25 and 2023-04-17.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2023-02-25' AND '2023-04-17'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find sale that have more than 5 products. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 5\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show order for the customer with email 'jfitjtvg@example.com' between 2025-08-21 and 2025-09-02.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'jfitjtvg@example.com' AND oh.order_entry_date BETWEEN '2025-08-21' AND '2025-09-02'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find purchase that have more than 3 products. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 3\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List order with order total above 250 and state 'processing' between 2025-08-27 and 2025-11-01. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 250 AND oh.order_status = 'processing' AND oh.order_entry_date BETWEEN '2025-08-27' AND '2025-11-01'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2025-08-10 and 2025-11-01.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2025-08-10' AND '2025-11-01'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "How many order are currently marked 'processing'?", "output": "SELECT COUNT(*) AS count\nFROM order_header\nWHERE order_status = 'processing';"}
{"instruction": "Write a SQL query based on the following request.", "input": "How many transaction are currently marked 'processing'?", "output": "SELECT COUNT(*) AS count\nFROM order_header\nWHERE order_status = 'processing';"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the articles for any purchase placed by a buyer with family name 'Hernandez' where the stage is 'refunded'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Hernandez' AND oh.order_status = 'refunded'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Benjamin Brown that include item 'SKU-ZKY22U' with at least 3 item count.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Benjamin' AND c.SURNAME = 'Brown' AND od.catalog_sku = 'SKU-ZKY22U' AND od.quantity >= 3\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find transaction that have more than 3 line items. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 3\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the products for any sale placed by a client with family name 'Perez' where the stage is 'on hold'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Perez' AND oh.order_status = 'on hold'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 10 items by revenue based on positions across all sale.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show new customer who joined after 2024-07-03, include name and email.", "output": "SELECT FNAME, SURNAME, email\nFROM buyers\nWHERE modify_date::date > '2024-07-03';"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the customer with mail address 'wgmpjawe@mail.test' from 2024-12-27 and 2025-04-18.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'wgmpjawe@mail.test' AND oh.order_entry_date BETWEEN '2024-12-27' AND '2025-04-18'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List sale with amount charged above 2500 and state 'shipped' between 2023-06-25 and 2023-08-01. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 2500 AND oh.order_status = 'shipped' AND oh.order_entry_date BETWEEN '2023-06-25' AND '2023-08-01'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List order with total due above 250 and state 'on hold' between 2025-10-02 and 2025-11-01. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 250 AND oh.order_status = 'on hold' AND oh.order_entry_date BETWEEN '2025-10-02' AND '2025-11-01'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 5 person by amount paid between 2024-05-13 and 2024-08-29?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-05-13' AND '2024-08-29'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List sale with grand total above 500 and state 'refunded' between 2024-11-08 and 2024-12-30. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 500 AND oh.order_status = 'refunded' AND oh.order_entry_date BETWEEN '2024-11-08' AND '2024-12-30'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every purchase that includes the item code 'SKU-IZL08Y'. Return the buyer name, the invoice number, and when it was order date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-IZL08Y'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Sofia Lee that include item 'SKU-KDGIGA' with at least 3 units.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Sofia' AND c.SURNAME = 'Lee' AND od.catalog_sku = 'SKU-KDGIGA' AND od.quantity >= 3\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List order with order total above 5000 and state 'processing' between 2025-10-02 and 2025-10-22. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 5000 AND oh.order_status = 'processing' AND oh.order_entry_date BETWEEN '2025-10-02' AND '2025-10-22'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 5 client by spend between 2025-06-21 and 2025-10-16?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2025-06-21' AND '2025-10-16'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2025-09-05 and 2025-11-01.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2025-09-05' AND '2025-11-01'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List person who made more than 2 order overall. Show name, email, and how many purchase.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 2\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2023-06-24 and 2023-09-25.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2023-06-24' AND '2023-09-25'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the positions for any sale placed by a account holder with family name 'Lee' where the progress is 'shipped'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Lee' AND oh.order_status = 'shipped'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every purchase that includes the item code 'SKU-VPUC8D'. Return the buyer name, the reference id, and when it was placed on.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-VPUC8D'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the products for any order placed by a account holder with family name 'Jackson' where the progress is 'paid'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Jackson' AND oh.order_status = 'paid'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Layla Hernandez that include item 'SKU-BKK4CI' with at least 10 quantity.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Layla' AND c.SURNAME = 'Hernandez' AND od.catalog_sku = 'SKU-BKK4CI' AND od.quantity >= 10\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 6 purchase overall. Show name, mail address, and how many purchase.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 6\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show sale for the account holder with email 'ehtohdrs@demo.org' between 2025-10-21 and 2025-11-01.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'ehtohdrs@demo.org' AND oh.order_entry_date BETWEEN '2025-10-21' AND '2025-11-01'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Victoria Martinez that include item 'SKU-AIY4VA' with at least 10 units.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Victoria' AND c.SURNAME = 'Martinez' AND od.catalog_sku = 'SKU-AIY4VA' AND od.quantity >= 10\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "How many sale are currently marked 'processing'?", "output": "SELECT COUNT(*) AS count\nFROM order_header\nWHERE order_status = 'processing';"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 10 items by revenue based on entries across all purchase.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List buyer who made more than 5 sale overall. Show name, mail address, and how many sale.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 5\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every sale that includes the item code 'SKU-Y4LYK8'. Return the buyer name, the order code, and when it was order date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-Y4LYK8'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 3 buyer by checkout total between 2025-04-07 and 2025-09-15?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2025-04-07' AND '2025-09-15'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 3;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List person who made more than 3 transaction overall. Show name, contact email, and how many sale.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 3\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find purchase that have more than 3 entries. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 3\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List order with order total above 500 and state 'on hold' between 2025-09-19 and 2025-10-11. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 500 AND oh.order_status = 'on hold' AND oh.order_entry_date BETWEEN '2025-09-19' AND '2025-10-11'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Michael Jackson that include item 'SKU-AOI4E8' with at least 5 count of pieces.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Michael' AND c.SURNAME = 'Jackson' AND od.catalog_sku = 'SKU-AOI4E8' AND od.quantity >= 5\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 10 items by revenue based on articles across all sale.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 10 client by checkout total during 2023-10-24 and 2024-02-29?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2023-10-24' AND '2024-02-29'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 5 customer by spend between 2024-11-27 and 2025-05-05?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-11-27' AND '2025-05-05'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Gianna Martin that include item 'SKU-9RFTMT' with at least 5 count of pieces.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Gianna' AND c.SURNAME = 'Martin' AND od.catalog_sku = 'SKU-9RFTMT' AND od.quantity >= 5\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 5 buyer by amount paid between 2024-04-23 and 2024-09-05?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-04-23' AND '2024-09-05'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Scarlett Wilson that include item 'SKU-92XF8E' with at least 1 item count.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Scarlett' AND c.SURNAME = 'Wilson' AND od.catalog_sku = 'SKU-92XF8E' AND od.quantity >= 1\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the articles for any purchase placed by a buyer with family name 'Smith' where the progress is 'processing'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Smith' AND oh.order_status = 'processing'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 10 buyer by amount paid between 2025-03-25 and 2025-10-07?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2025-03-25' AND '2025-10-07'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find order that have more than 10 positions. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 10\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the buyer with email 'qxztlcqw@sample.io' from 2023-12-07 and 2024-03-14.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'qxztlcqw@sample.io' AND oh.order_entry_date BETWEEN '2023-12-07' AND '2024-03-14'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 5 client by checkout total between 2025-06-01 and 2025-08-07?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2025-06-01' AND '2025-08-07'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List sale with order total above 250 and state 'processing' between 2023-12-25 and 2024-01-11. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 250 AND oh.order_status = 'processing' AND oh.order_entry_date BETWEEN '2023-12-25' AND '2024-01-11'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find purchase that have more than 10 products. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 10\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show new account holder who joined after 2024-06-04, include name and mail address.", "output": "SELECT FNAME, SURNAME, email\nFROM buyers\nWHERE modify_date::date > '2024-06-04';"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find transaction that have more than 10 positions. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 10\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the articles for any transaction placed by a account holder with family name 'Gonzalez' where the progress is 'delivered'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Gonzalez' AND oh.order_status = 'delivered'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 5 client by amount paid between 2025-09-16 and 2025-11-01?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2025-09-16' AND '2025-11-01'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List sale with grand total above 5000 and state 'delivered' between 2023-02-14 and 2023-06-07. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 5000 AND oh.order_status = 'delivered' AND oh.order_entry_date BETWEEN '2023-02-14' AND '2023-06-07'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show purchase for the person with mail address 'wuzxtvxu@mail.test' between 2024-12-22 and 2025-01-29.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'wuzxtvxu@mail.test' AND oh.order_entry_date BETWEEN '2024-12-22' AND '2025-01-29'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find transaction that have more than 3 articles. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 3\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show purchase for the customer with mail address 'jdxikfuw@demo.org' from 2025-10-24 and 2025-11-01.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'jdxikfuw@demo.org' AND oh.order_entry_date BETWEEN '2025-10-24' AND '2025-11-01'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Daniel Clark that include item 'SKU-E8F840' with at least 10 count of pieces.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Daniel' AND c.SURNAME = 'Clark' AND od.catalog_sku = 'SKU-E8F840' AND od.quantity >= 10\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show purchase for the account holder with email 'kgdjtgjq@demo.org' from 2023-08-10 and 2023-11-14.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'kgdjtgjq@demo.org' AND oh.order_entry_date BETWEEN '2023-08-10' AND '2023-11-14'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2024-03-29 and 2024-10-10.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2024-03-29' AND '2024-10-10'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show purchase for the account holder with mail address 'vxhkdyhm@example.com' from 2024-04-25 and 2024-07-12.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'vxhkdyhm@example.com' AND oh.order_entry_date BETWEEN '2024-04-25' AND '2024-07-12'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find sale that have more than 12 positions. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 12\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Mia Robinson that include item 'SKU-ODRO8B' with at least 2 item count.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Mia' AND c.SURNAME = 'Robinson' AND od.catalog_sku = 'SKU-ODRO8B' AND od.quantity >= 2\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List customer who made more than 3 order overall. Show name, contact email, and how many transaction.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 3\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List transaction with cart total above 5000 and state 'canceled' between 2023-05-05 and 2023-07-01. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 5000 AND oh.order_status = 'canceled' AND oh.order_entry_date BETWEEN '2023-05-05' AND '2023-07-01'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2025-07-20 and 2025-09-11.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2025-07-20' AND '2025-09-11'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find order that have more than 12 line items. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 12\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 3 person by spend during 2024-02-25 and 2024-04-12?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-02-25' AND '2024-04-12'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 3;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 3 client by spend between 2023-01-06 and 2023-04-16?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2023-01-06' AND '2023-04-16'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 3;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the entries for any purchase placed by a person with family name 'Jones' where the progress is 'pending'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Jones' AND oh.order_status = 'pending'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show order for the person with mail address 'gdkcbljp@sample.io' from 2025-10-28 and 2025-11-01.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'gdkcbljp@sample.io' AND oh.order_entry_date BETWEEN '2025-10-28' AND '2025-11-01'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find order that have more than 3 articles. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 3\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List account holder who made more than 2 sale overall. Show name, email, and how many order.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 2\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every sale that includes the item code 'SKU-FEWVZN'. Return the buyer name, the ticket id, and when it was transaction date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-FEWVZN'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List person who made more than 2 purchase overall. Show name, mail address, and how many sale.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 2\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List account holder who made more than 5 sale overall. Show name, contact email, and how many order.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 5\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every order that includes the item code 'SKU-LJ8YRD'. Return the buyer name, the invoice number, and when it was placed on.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-LJ8YRD'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Jackson Clark that include item 'SKU-EC8UYO' with at least 1 count of pieces.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Jackson' AND c.SURNAME = 'Clark' AND od.catalog_sku = 'SKU-EC8UYO' AND od.quantity >= 1\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List sale with cart total above 500 and state 'paid' between 2024-03-11 and 2024-04-06. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 500 AND oh.order_status = 'paid' AND oh.order_entry_date BETWEEN '2024-03-11' AND '2024-04-06'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every transaction that includes the item code 'SKU-UEKIPU'. Return the buyer name, the order code, and when it was date of purchase.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-UEKIPU'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 5 buyer by spend during 2024-11-26 and 2025-03-25?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-11-26' AND '2025-03-25'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List order with total due above 1000 and state 'paid' between 2023-10-18 and 2024-01-27. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 1000 AND oh.order_status = 'paid' AND oh.order_entry_date BETWEEN '2023-10-18' AND '2024-01-27'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Harper Wilson that include item 'SKU-PMNZ1U' with at least 1 quantity.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Harper' AND c.SURNAME = 'Wilson' AND od.catalog_sku = 'SKU-PMNZ1U' AND od.quantity >= 1\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the entries for any sale placed by a account holder with family name 'Johnson' where the progress is 'paid'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Johnson' AND oh.order_status = 'paid'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List order with grand total above 1000 and state 'delivered' between 2024-03-17 and 2024-06-28. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 1000 AND oh.order_status = 'delivered' AND oh.order_entry_date BETWEEN '2024-03-17' AND '2024-06-28'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List person who made more than 4 sale overall. Show name, contact email, and how many transaction.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 4\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show sale for the client with email 'kpahfdgi@example.com' from 2025-10-15 and 2025-11-01.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'kpahfdgi@example.com' AND oh.order_entry_date BETWEEN '2025-10-15' AND '2025-11-01'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 5 items by revenue based on positions across all transaction.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show sale for the buyer with mail address 'wbaxwoos@sample.io' between 2024-08-15 and 2024-09-08.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'wbaxwoos@sample.io' AND oh.order_entry_date BETWEEN '2024-08-15' AND '2024-09-08'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List order with cart total above 5000 and state 'canceled' between 2023-06-30 and 2023-08-31. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 5000 AND oh.order_status = 'canceled' AND oh.order_entry_date BETWEEN '2023-06-30' AND '2023-08-31'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List person who made more than 5 order overall. Show name, mail address, and how many transaction.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 5\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for James Lopez that include item 'SKU-2CWTG1' with at least 2 quantity.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'James' AND c.SURNAME = 'Lopez' AND od.catalog_sku = 'SKU-2CWTG1' AND od.quantity >= 2\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the positions for any purchase placed by a buyer with family name 'Miller' where the state is 'processing'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Miller' AND oh.order_status = 'processing'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find sale that have more than 10 positions. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 10\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find transaction that have more than 12 entries. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 12\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the entries for any transaction placed by a person with family name 'Taylor' where the state is 'on hold'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Taylor' AND oh.order_status = 'on hold'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every sale that includes the item code 'SKU-CQBNKX'. Return the buyer name, the invoice number, and when it was transaction date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-CQBNKX'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List purchase with grand total above 5000 and state 'pending' between 2025-07-10 and 2025-10-28. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 5000 AND oh.order_status = 'pending' AND oh.order_entry_date BETWEEN '2025-07-10' AND '2025-10-28'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List order with grand total above 2500 and state 'processing' between 2023-05-07 and 2023-07-10. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 2500 AND oh.order_status = 'processing' AND oh.order_entry_date BETWEEN '2023-05-07' AND '2023-07-10'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the person with email 'qbsznpjx@sample.io' from 2025-04-17 and 2025-08-04.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'qbsznpjx@sample.io' AND oh.order_entry_date BETWEEN '2025-04-17' AND '2025-08-04'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the account holder with email 'crhsrxwi@acme.co' between 2023-10-17 and 2023-12-10.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'crhsrxwi@acme.co' AND oh.order_entry_date BETWEEN '2023-10-17' AND '2023-12-10'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every sale that includes the item code 'SKU-N23Y30'. Return the buyer name, the ticket id, and when it was order date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-N23Y30'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the person with email 'iyitezeh@example.com' from 2023-03-19 and 2023-06-21.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'iyitezeh@example.com' AND oh.order_entry_date BETWEEN '2023-03-19' AND '2023-06-21'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the articles for any order placed by a account holder with family name 'Ramirez' where the progress is 'processing'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Ramirez' AND oh.order_status = 'processing'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find sale that have more than 5 positions. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 5\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 10 person by spend between 2025-07-08 and 2025-10-05?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2025-07-08' AND '2025-10-05'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2024-02-02 and 2024-06-05.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2024-02-02' AND '2024-06-05'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find sale that have more than 12 articles. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 12\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "How many sale are currently marked 'refunded'?", "output": "SELECT COUNT(*) AS count\nFROM order_header\nWHERE order_status = 'refunded';"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the entries for any order placed by a person with family name 'Johnson' where the state is 'on hold'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Johnson' AND oh.order_status = 'on hold'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 3 person by spend between 2024-07-12 and 2024-12-04?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-07-12' AND '2024-12-04'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 3;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show order for the customer with email 'xvxykkjk@example.com' from 2025-02-06 and 2025-03-16.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'xvxykkjk@example.com' AND oh.order_entry_date BETWEEN '2025-02-06' AND '2025-03-16'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the products for any sale placed by a account holder with family name 'Ramirez' where the stage is 'on hold'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Ramirez' AND oh.order_status = 'on hold'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show purchase for the account holder with contact email 'cgvosnch@demo.org' from 2023-09-07 and 2023-09-23.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'cgvosnch@demo.org' AND oh.order_entry_date BETWEEN '2023-09-07' AND '2023-09-23'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show sale for the client with contact email 'vmnqosha@demo.org' between 2024-05-07 and 2024-07-29.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'vmnqosha@demo.org' AND oh.order_entry_date BETWEEN '2024-05-07' AND '2024-07-29'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 10 items by revenue based on line items across all order.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List buyer who made more than 5 sale overall. Show name, mail address, and how many transaction.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 5\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Ella Clark that include item 'SKU-CIXDU1' with at least 1 count of pieces.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Ella' AND c.SURNAME = 'Clark' AND od.catalog_sku = 'SKU-CIXDU1' AND od.quantity >= 1\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List sale with cart total above 5000 and state 'processing' between 2025-08-09 and 2025-11-01. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 5000 AND oh.order_status = 'processing' AND oh.order_entry_date BETWEEN '2025-08-09' AND '2025-11-01'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show order for the client with mail address 'ulhbfbyn@acme.co' from 2025-08-27 and 2025-10-08.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'ulhbfbyn@acme.co' AND oh.order_entry_date BETWEEN '2025-08-27' AND '2025-10-08'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show sale for the customer with contact email 'rhulklyi@mail.test' from 2025-10-13 and 2025-11-01.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'rhulklyi@mail.test' AND oh.order_entry_date BETWEEN '2025-10-13' AND '2025-11-01'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Mason Anderson that include item 'SKU-V3TLCX' with at least 5 item count.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Mason' AND c.SURNAME = 'Anderson' AND od.catalog_sku = 'SKU-V3TLCX' AND od.quantity >= 5\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the line items for any transaction placed by a person with family name 'Gonzalez' where the progress is 'on hold'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Gonzalez' AND oh.order_status = 'on hold'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 3 account holder by amount paid during 2023-06-03 and 2023-12-13?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2023-06-03' AND '2023-12-13'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 3;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the line items for any purchase placed by a buyer with family name 'Thompson' where the state is 'on hold'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Thompson' AND oh.order_status = 'on hold'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "How many transaction are currently marked 'canceled'?", "output": "SELECT COUNT(*) AS count\nFROM order_header\nWHERE order_status = 'canceled';"}
{"instruction": "Write a SQL query based on the following request.", "input": "List buyer who made more than 6 purchase overall. Show name, contact email, and how many sale.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 6\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2025-01-31 and 2025-06-23.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2025-01-31' AND '2025-06-23'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "How many transaction are currently marked 'processing'?", "output": "SELECT COUNT(*) AS count\nFROM order_header\nWHERE order_status = 'processing';"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 4 order overall. Show name, email, and how many purchase.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 4\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 10 items by revenue based on positions across all order.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 5 person by amount paid between 2025-07-02 and 2025-09-24?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2025-07-02' AND '2025-09-24'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 3 client by checkout total between 2023-06-01 and 2023-10-24?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2023-06-01' AND '2023-10-24'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 3;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find transaction that have more than 3 entries. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 3\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Amelia Clark that include item 'SKU-NI92IR' with at least 10 count of pieces.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Amelia' AND c.SURNAME = 'Clark' AND od.catalog_sku = 'SKU-NI92IR' AND od.quantity >= 10\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show new person who joined after 2023-09-23, include name and email.", "output": "SELECT FNAME, SURNAME, email\nFROM buyers\nWHERE modify_date::date > '2023-09-23';"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the client with contact email 'ksmkkodi@example.com' between 2025-07-10 and 2025-09-17.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'ksmkkodi@example.com' AND oh.order_entry_date BETWEEN '2025-07-10' AND '2025-09-17'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "How many sale are currently marked 'processing'?", "output": "SELECT COUNT(*) AS count\nFROM order_header\nWHERE order_status = 'processing';"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 5 items by revenue based on line items across all purchase.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every transaction that includes the item code 'SKU-F7I8SK'. Return the buyer name, the receipt number, and when it was transaction date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-F7I8SK'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 10 person by spend during 2024-09-12 and 2025-03-18?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-09-12' AND '2025-03-18'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List transaction with order total above 2500 and state 'processing' between 2023-12-17 and 2024-03-17. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 2500 AND oh.order_status = 'processing' AND oh.order_entry_date BETWEEN '2023-12-17' AND '2024-03-17'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the customer with mail address 'wcyugfoq@example.com' between 2025-10-16 and 2025-11-01.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'wcyugfoq@example.com' AND oh.order_entry_date BETWEEN '2025-10-16' AND '2025-11-01'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find sale that have more than 8 line items. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 8\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Lucas Thomas that include item 'SKU-OQMF5L' with at least 5 quantity.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Lucas' AND c.SURNAME = 'Thomas' AND od.catalog_sku = 'SKU-OQMF5L' AND od.quantity >= 5\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "How many transaction are currently marked 'paid'?", "output": "SELECT COUNT(*) AS count\nFROM order_header\nWHERE order_status = 'paid';"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 3 client by spend during 2024-07-01 and 2024-11-23?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-07-01' AND '2024-11-23'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 3;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show sale for the account holder with mail address 'ywkzxvys@mail.test' from 2023-11-23 and 2024-02-04.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'ywkzxvys@mail.test' AND oh.order_entry_date BETWEEN '2023-11-23' AND '2024-02-04'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show order for the buyer with mail address 'ynzfjbmw@sample.io' between 2024-08-08 and 2024-10-25.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'ynzfjbmw@sample.io' AND oh.order_entry_date BETWEEN '2024-08-08' AND '2024-10-25'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Aiden Gonzalez that include item 'SKU-BBUNKN' with at least 10 count of pieces.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Aiden' AND c.SURNAME = 'Gonzalez' AND od.catalog_sku = 'SKU-BBUNKN' AND od.quantity >= 10\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find order that have more than 12 products. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 12\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List person who made more than 4 transaction overall. Show name, email, and how many purchase.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 4\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List purchase with grand total above 1000 and state 'pending' between 2023-04-03 and 2023-04-14. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 1000 AND oh.order_status = 'pending' AND oh.order_entry_date BETWEEN '2023-04-03' AND '2023-04-14'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 5 items by revenue based on positions across all purchase.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every transaction that includes the item code 'SKU-WF90KM'. Return the buyer name, the invoice number, and when it was placed on.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-WF90KM'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every sale that includes the item code 'SKU-Y9V20Y'. Return the buyer name, the reference id, and when it was transaction date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-Y9V20Y'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List sale with cart total above 5000 and state 'pending' between 2025-09-10 and 2025-10-08. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 5000 AND oh.order_status = 'pending' AND oh.order_entry_date BETWEEN '2025-09-10' AND '2025-10-08'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 10 buyer by amount paid between 2023-08-14 and 2023-10-31?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2023-08-14' AND '2023-10-31'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 5 sale overall. Show name, contact email, and how many sale.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 5\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Emma White that include item 'SKU-EHLXSL' with at least 5 count of pieces.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Emma' AND c.SURNAME = 'White' AND od.catalog_sku = 'SKU-EHLXSL' AND od.quantity >= 5\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List purchase with grand total above 5000 and state 'delivered' between 2025-09-18 and 2025-10-19. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 5000 AND oh.order_status = 'delivered' AND oh.order_entry_date BETWEEN '2025-09-18' AND '2025-10-19'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List purchase with amount charged above 250 and state 'delivered' between 2024-08-14 and 2024-11-19. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 250 AND oh.order_status = 'delivered' AND oh.order_entry_date BETWEEN '2024-08-14' AND '2024-11-19'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every sale that includes the item code 'SKU-M72JEY'. Return the buyer name, the reference id, and when it was date of purchase.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-M72JEY'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 5 account holder by checkout total between 2023-06-11 and 2023-10-07?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2023-06-11' AND '2023-10-07'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Harper Miller that include item 'SKU-3JUJD0' with at least 2 units.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Harper' AND c.SURNAME = 'Miller' AND od.catalog_sku = 'SKU-3JUJD0' AND od.quantity >= 2\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find purchase that have more than 12 products. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 12\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show purchase for the customer with mail address 'kscuaoyk@sample.io' from 2025-09-04 and 2025-11-01.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'kscuaoyk@sample.io' AND oh.order_entry_date BETWEEN '2025-09-04' AND '2025-11-01'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find purchase that have more than 3 positions. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 3\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Noah Garcia that include item 'SKU-P47B42' with at least 3 units.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Noah' AND c.SURNAME = 'Garcia' AND od.catalog_sku = 'SKU-P47B42' AND od.quantity >= 3\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show purchase for the buyer with mail address 'oczhzomy@acme.co' between 2025-08-16 and 2025-09-29.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'oczhzomy@acme.co' AND oh.order_entry_date BETWEEN '2025-08-16' AND '2025-09-29'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Elijah White that include item 'SKU-G02U1G' with at least 5 count of pieces.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Elijah' AND c.SURNAME = 'White' AND od.catalog_sku = 'SKU-G02U1G' AND od.quantity >= 5\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show order for the customer with contact email 'redigggt@demo.org' from 2024-09-10 and 2024-12-03.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'redigggt@demo.org' AND oh.order_entry_date BETWEEN '2024-09-10' AND '2024-12-03'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Emma Thompson that include item 'SKU-ELOS6Z' with at least 1 count of pieces.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Emma' AND c.SURNAME = 'Thompson' AND od.catalog_sku = 'SKU-ELOS6Z' AND od.quantity >= 1\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every purchase that includes the item code 'SKU-H8RQ9N'. Return the buyer name, the receipt number, and when it was transaction date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-H8RQ9N'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show sale for the buyer with contact email 'lscobono@mail.test' between 2023-12-03 and 2024-01-23.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'lscobono@mail.test' AND oh.order_entry_date BETWEEN '2023-12-03' AND '2024-01-23'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Luna Williams that include item 'SKU-6QCEOU' with at least 3 units.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Luna' AND c.SURNAME = 'Williams' AND od.catalog_sku = 'SKU-6QCEOU' AND od.quantity >= 3\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 2 order overall. Show name, email, and how many sale.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 2\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every purchase that includes the item code 'SKU-C97C7B'. Return the buyer name, the receipt number, and when it was checkout day.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-C97C7B'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every transaction that includes the item code 'SKU-6Q7NC8'. Return the buyer name, the order code, and when it was date of purchase.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-6Q7NC8'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 3 order overall. Show name, email, and how many transaction.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 3\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show new person who joined after 2025-05-18, include name and mail address.", "output": "SELECT FNAME, SURNAME, email\nFROM buyers\nWHERE modify_date::date > '2025-05-18';"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 5 client by checkout total during 2023-11-14 and 2024-02-22?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2023-11-14' AND '2024-02-22'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show order for the account holder with mail address 'rpyxgbpl@example.com' between 2024-05-16 and 2024-08-28.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'rpyxgbpl@example.com' AND oh.order_entry_date BETWEEN '2024-05-16' AND '2024-08-28'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 5 items by revenue based on products across all transaction.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 10 person by checkout total between 2024-10-15 and 2025-04-10?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-10-15' AND '2025-04-10'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 3 customer by amount paid during 2024-03-28 and 2024-08-10?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-03-28' AND '2024-08-10'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 3;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List sale with total due above 2500 and state 'processing' between 2025-05-24 and 2025-08-10. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 2500 AND oh.order_status = 'processing' AND oh.order_entry_date BETWEEN '2025-05-24' AND '2025-08-10'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2025-02-19 and 2025-08-02.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2025-02-19' AND '2025-08-02'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every purchase that includes the item code 'SKU-OFN1R4'. Return the buyer name, the invoice number, and when it was placed on.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-OFN1R4'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List transaction with cart total above 1000 and state 'processing' between 2025-03-06 and 2025-04-13. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 1000 AND oh.order_status = 'processing' AND oh.order_entry_date BETWEEN '2025-03-06' AND '2025-04-13'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every order that includes the item code 'SKU-CQNT3B'. Return the buyer name, the order code, and when it was date of purchase.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-CQNT3B'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List transaction with grand total above 5000 and state 'shipped' between 2025-09-08 and 2025-10-11. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 5000 AND oh.order_status = 'shipped' AND oh.order_entry_date BETWEEN '2025-09-08' AND '2025-10-11'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the account holder with mail address 'yzdzmgpf@mail.test' from 2024-10-20 and 2025-02-06.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'yzdzmgpf@mail.test' AND oh.order_entry_date BETWEEN '2024-10-20' AND '2025-02-06'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every purchase that includes the item code 'SKU-M5Q201'. Return the buyer name, the reference id, and when it was order date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-M5Q201'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 6 purchase overall. Show name, email, and how many transaction.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 6\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List purchase with grand total above 2500 and state 'refunded' between 2024-08-27 and 2024-09-22. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 2500 AND oh.order_status = 'refunded' AND oh.order_entry_date BETWEEN '2024-08-27' AND '2024-09-22'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 10 person by checkout total between 2024-05-18 and 2024-10-22?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-05-18' AND '2024-10-22'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 5 client by checkout total between 2025-10-01 and 2025-11-01?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2025-10-01' AND '2025-11-01'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the positions for any order placed by a person with family name 'Taylor' where the state is 'processing'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Taylor' AND oh.order_status = 'processing'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show sale for the account holder with email 'vbadqbdf@sample.io' between 2025-02-03 and 2025-02-20.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'vbadqbdf@sample.io' AND oh.order_entry_date BETWEEN '2025-02-03' AND '2025-02-20'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 10 items by revenue based on line items across all order.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 10 items by revenue based on positions across all transaction.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the customer with mail address 'vruxccde@acme.co' between 2024-05-31 and 2024-09-22.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'vruxccde@acme.co' AND oh.order_entry_date BETWEEN '2024-05-31' AND '2024-09-22'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every order that includes the item code 'SKU-OU9IY4'. Return the buyer name, the invoice number, and when it was checkout day.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-OU9IY4'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List buyer who made more than 5 order overall. Show name, contact email, and how many purchase.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 5\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show order for the buyer with contact email 'vqizzxxf@acme.co' from 2025-08-31 and 2025-10-14.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'vqizzxxf@acme.co' AND oh.order_entry_date BETWEEN '2025-08-31' AND '2025-10-14'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2023-03-09 and 2023-05-23.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2023-03-09' AND '2023-05-23'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2024-10-06 and 2024-11-09.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2024-10-06' AND '2024-11-09'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List purchase with order total above 5000 and state 'refunded' between 2023-06-07 and 2023-07-22. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 5000 AND oh.order_status = 'refunded' AND oh.order_entry_date BETWEEN '2023-06-07' AND '2023-07-22'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 5 client by checkout total during 2024-11-10 and 2025-03-18?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-11-10' AND '2025-03-18'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 10 items by revenue based on line items across all order.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List customer who made more than 2 sale overall. Show name, mail address, and how many order.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 2\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find sale that have more than 10 products. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 10\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every order that includes the item code 'SKU-7PYXDW'. Return the buyer name, the order code, and when it was order date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-7PYXDW'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the entries for any transaction placed by a buyer with family name 'Harris' where the state is 'refunded'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Harris' AND oh.order_status = 'refunded'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show order for the person with contact email 'ijhdelok@example.com' from 2023-07-03 and 2023-08-27.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'ijhdelok@example.com' AND oh.order_entry_date BETWEEN '2023-07-03' AND '2023-08-27'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the customer with mail address 'kusozgnr@mail.test' between 2023-10-12 and 2023-11-25.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'kusozgnr@mail.test' AND oh.order_entry_date BETWEEN '2023-10-12' AND '2023-11-25'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show purchase for the customer with email 'lkmbggqp@mail.test' from 2025-07-26 and 2025-08-18.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'lkmbggqp@mail.test' AND oh.order_entry_date BETWEEN '2025-07-26' AND '2025-08-18'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every transaction that includes the item code 'SKU-W2LM34'. Return the buyer name, the reference id, and when it was transaction date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-W2LM34'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2024-02-16 and 2024-07-17.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2024-02-16' AND '2024-07-17'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every transaction that includes the item code 'SKU-88KZRU'. Return the buyer name, the invoice number, and when it was order date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-88KZRU'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List person who made more than 2 purchase overall. Show name, contact email, and how many purchase.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 2\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find order that have more than 12 articles. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 12\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2024-03-05 and 2024-07-25.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2024-03-05' AND '2024-07-25'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show sale for the person with mail address 'wurdhgel@sample.io' from 2023-06-01 and 2023-08-07.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'wurdhgel@sample.io' AND oh.order_entry_date BETWEEN '2023-06-01' AND '2023-08-07'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List purchase with grand total above 500 and state 'paid' between 2023-08-12 and 2023-11-25. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 500 AND oh.order_status = 'paid' AND oh.order_entry_date BETWEEN '2023-08-12' AND '2023-11-25'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the entries for any sale placed by a buyer with family name 'Johnson' where the state is 'refunded'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Johnson' AND oh.order_status = 'refunded'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the articles for any transaction placed by a account holder with family name 'Moore' where the progress is 'shipped'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Moore' AND oh.order_status = 'shipped'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "How many transaction are currently marked 'processing'?", "output": "SELECT COUNT(*) AS count\nFROM order_header\nWHERE order_status = 'processing';"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 10 items by revenue based on articles across all order.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the entries for any sale placed by a client with family name 'Gonzalez' where the stage is 'delivered'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Gonzalez' AND oh.order_status = 'delivered'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 10 items by revenue based on line items across all sale.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Zoe Lopez that include item 'SKU-CBZAMD' with at least 2 quantity.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Zoe' AND c.SURNAME = 'Lopez' AND od.catalog_sku = 'SKU-CBZAMD' AND od.quantity >= 2\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List sale with cart total above 500 and state 'refunded' between 2025-08-04 and 2025-09-09. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 500 AND oh.order_status = 'refunded' AND oh.order_entry_date BETWEEN '2025-08-04' AND '2025-09-09'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the positions for any purchase placed by a account holder with family name 'Wilson' where the stage is 'pending'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Wilson' AND oh.order_status = 'pending'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 2 purchase overall. Show name, mail address, and how many order.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 2\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List purchase with amount charged above 2500 and state 'processing' between 2025-01-19 and 2025-03-08. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 2500 AND oh.order_status = 'processing' AND oh.order_entry_date BETWEEN '2025-01-19' AND '2025-03-08'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the positions for any sale placed by a person with family name 'Moore' where the progress is 'canceled'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Moore' AND oh.order_status = 'canceled'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List purchase with grand total above 500 and state 'canceled' between 2025-07-26 and 2025-10-20. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 500 AND oh.order_status = 'canceled' AND oh.order_entry_date BETWEEN '2025-07-26' AND '2025-10-20'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2023-06-23 and 2023-08-26.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2023-06-23' AND '2023-08-26'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every sale that includes the item code 'SKU-IENFNV'. Return the buyer name, the receipt number, and when it was checkout day.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-IENFNV'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find purchase that have more than 5 articles. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 5\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 3 person by spend between 2024-10-06 and 2025-02-28?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-10-06' AND '2025-02-28'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 3;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 5 items by revenue based on articles across all sale.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List account holder who made more than 5 sale overall. Show name, mail address, and how many purchase.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 5\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show order for the customer with contact email 'athhnelt@sample.io' from 2023-08-20 and 2023-11-11.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'athhnelt@sample.io' AND oh.order_entry_date BETWEEN '2023-08-20' AND '2023-11-11'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List order with cart total above 100 and state 'on hold' between 2024-03-23 and 2024-05-23. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 100 AND oh.order_status = 'on hold' AND oh.order_entry_date BETWEEN '2024-03-23' AND '2024-05-23'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every purchase that includes the item code 'SKU-9QM3P9'. Return the buyer name, the ticket id, and when it was order date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-9QM3P9'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List purchase with cart total above 1000 and state 'processing' between 2023-10-13 and 2024-01-28. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 1000 AND oh.order_status = 'processing' AND oh.order_entry_date BETWEEN '2023-10-13' AND '2024-01-28'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List transaction with grand total above 2500 and state 'delivered' between 2023-12-11 and 2024-01-28. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 2500 AND oh.order_status = 'delivered' AND oh.order_entry_date BETWEEN '2023-12-11' AND '2024-01-28'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List sale with total due above 2500 and state 'paid' between 2023-10-05 and 2024-01-16. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 2500 AND oh.order_status = 'paid' AND oh.order_entry_date BETWEEN '2023-10-05' AND '2024-01-16'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the entries for any purchase placed by a account holder with family name 'Davis' where the progress is 'processing'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Davis' AND oh.order_status = 'processing'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the articles for any sale placed by a buyer with family name 'Perez' where the stage is 'refunded'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Perez' AND oh.order_status = 'refunded'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "How many transaction are currently marked 'refunded'?", "output": "SELECT COUNT(*) AS count\nFROM order_header\nWHERE order_status = 'refunded';"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Jackson Thomas that include item 'SKU-8LA100' with at least 3 units.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Jackson' AND c.SURNAME = 'Thomas' AND od.catalog_sku = 'SKU-8LA100' AND od.quantity >= 3\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 5 sale overall. Show name, mail address, and how many transaction.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 5\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every sale that includes the item code 'SKU-UURMYB'. Return the buyer name, the order code, and when it was placed on.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-UURMYB'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2023-11-20 and 2024-04-10.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2023-11-20' AND '2024-04-10'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show new client who joined after 2025-05-26, include name and contact email.", "output": "SELECT FNAME, SURNAME, email\nFROM buyers\nWHERE modify_date::date > '2025-05-26';"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2024-09-10 and 2024-11-19.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2024-09-10' AND '2024-11-19'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show order for the buyer with email 'jcrqbqst@sample.io' from 2023-07-06 and 2023-10-14.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'jcrqbqst@sample.io' AND oh.order_entry_date BETWEEN '2023-07-06' AND '2023-10-14'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show sale for the buyer with contact email 'pnlaidws@sample.io' between 2023-05-26 and 2023-07-04.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'pnlaidws@sample.io' AND oh.order_entry_date BETWEEN '2023-05-26' AND '2023-07-04'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the products for any sale placed by a client with family name 'Robinson' where the stage is 'delivered'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Robinson' AND oh.order_status = 'delivered'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the positions for any purchase placed by a account holder with family name 'Martin' where the progress is 'pending'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Martin' AND oh.order_status = 'pending'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Mia Anderson that include item 'SKU-WPH6FE' with at least 3 item count.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Mia' AND c.SURNAME = 'Anderson' AND od.catalog_sku = 'SKU-WPH6FE' AND od.quantity >= 3\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every transaction that includes the item code 'SKU-FJDTVV'. Return the buyer name, the receipt number, and when it was transaction date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-FJDTVV'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List order with cart total above 250 and state 'refunded' between 2024-08-28 and 2024-11-25. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 250 AND oh.order_status = 'refunded' AND oh.order_entry_date BETWEEN '2024-08-28' AND '2024-11-25'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 5 items by revenue based on products across all sale.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find order that have more than 3 entries. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 3\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2023-09-28 and 2024-02-04.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2023-09-28' AND '2024-02-04'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List order with total due above 500 and state 'processing' between 2025-08-22 and 2025-11-01. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 500 AND oh.order_status = 'processing' AND oh.order_entry_date BETWEEN '2025-08-22' AND '2025-11-01'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List order with amount charged above 100 and state 'delivered' between 2024-03-17 and 2024-03-29. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 100 AND oh.order_status = 'delivered' AND oh.order_entry_date BETWEEN '2024-03-17' AND '2024-03-29'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 10 items by revenue based on articles across all sale.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show sale for the client with email 'nqhinfvn@sample.io' between 2023-05-16 and 2023-07-04.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'nqhinfvn@sample.io' AND oh.order_entry_date BETWEEN '2023-05-16' AND '2023-07-04'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the person with contact email 'llpittds@example.com' from 2023-12-02 and 2024-02-13.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'llpittds@example.com' AND oh.order_entry_date BETWEEN '2023-12-02' AND '2024-02-13'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the line items for any order placed by a customer with family name 'Harris' where the progress is 'delivered'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Harris' AND oh.order_status = 'delivered'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 3 buyer by amount paid between 2024-06-22 and 2024-12-16?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-06-22' AND '2024-12-16'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 3;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 5 items by revenue based on articles across all purchase.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every order that includes the item code 'SKU-JDU0IS'. Return the buyer name, the receipt number, and when it was placed on.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-JDU0IS'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show new client who joined after 2025-02-23, include name and email.", "output": "SELECT FNAME, SURNAME, email\nFROM buyers\nWHERE modify_date::date > '2025-02-23';"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2023-03-14 and 2023-09-01.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2023-03-14' AND '2023-09-01'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Grace Davis that include item 'SKU-LOZJCN' with at least 2 quantity.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Grace' AND c.SURNAME = 'Davis' AND od.catalog_sku = 'SKU-LOZJCN' AND od.quantity >= 2\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the person with mail address 'mhvioafo@demo.org' between 2024-05-11 and 2024-07-19.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'mhvioafo@demo.org' AND oh.order_entry_date BETWEEN '2024-05-11' AND '2024-07-19'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Nora Sanchez that include item 'SKU-2F7ATW' with at least 3 units.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Nora' AND c.SURNAME = 'Sanchez' AND od.catalog_sku = 'SKU-2F7ATW' AND od.quantity >= 3\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "How many transaction are currently marked 'refunded'?", "output": "SELECT COUNT(*) AS count\nFROM order_header\nWHERE order_status = 'refunded';"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the articles for any order placed by a client with family name 'Davis' where the stage is 'refunded'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Davis' AND oh.order_status = 'refunded'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 3 account holder by checkout total between 2024-04-19 and 2024-09-29?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-04-19' AND '2024-09-29'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 3;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show new person who joined after 2023-06-23, include name and email.", "output": "SELECT FNAME, SURNAME, email\nFROM buyers\nWHERE modify_date::date > '2023-06-23';"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 10 items by revenue based on line items across all order.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 10;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 3 transaction overall. Show name, mail address, and how many transaction.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 3\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2025-03-15 and 2025-07-06.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2025-03-15' AND '2025-07-06'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every sale that includes the item code 'SKU-JCH2VF'. Return the buyer name, the invoice number, and when it was order date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-JCH2VF'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List customer who made more than 6 purchase overall. Show name, mail address, and how many transaction.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 6\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show new buyer who joined after 2023-09-03, include name and email.", "output": "SELECT FNAME, SURNAME, email\nFROM buyers\nWHERE modify_date::date > '2023-09-03';"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every sale that includes the item code 'SKU-ZVH4FZ'. Return the buyer name, the ticket id, and when it was placed on.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-ZVH4FZ'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find purchase that have more than 8 line items. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 8\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Give me monthly revenue across all sales, with the year-month and the sum of amounts.", "output": "SELECT to_char(oh.order_entry_date, 'YYYY-MM') AS ym, SUM(oh.order_total_amount) AS revenue\nFROM order_header oh\nGROUP BY 1\nORDER BY 1;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List order with cart total above 2500 and state 'shipped' between 2023-07-13 and 2023-09-17. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 2500 AND oh.order_status = 'shipped' AND oh.order_entry_date BETWEEN '2023-07-13' AND '2023-09-17'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the products for any purchase placed by a account holder with family name 'Ramirez' where the progress is 'shipped'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Ramirez' AND oh.order_status = 'shipped'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find transaction that have more than 3 line items. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 3\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show sale for the account holder with mail address 'bxldxvib@sample.io' between 2023-04-14 and 2023-05-15.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'bxldxvib@sample.io' AND oh.order_entry_date BETWEEN '2023-04-14' AND '2023-05-15'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 5 transaction overall. Show name, email, and how many purchase.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 5\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 5 person by checkout total during 2023-11-01 and 2023-12-09?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2023-11-01' AND '2023-12-09'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find sale that have more than 10 positions. Return the buyer, the reference, and how many entries.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, COUNT(*) AS line_count\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nGROUP BY c.FNAME, c.SURNAME, oh.oe_number\nHAVING COUNT(*) > 10\nORDER BY line_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Return the top 5 items by revenue based on entries across all sale.", "output": "SELECT od.catalog_sku, SUM(od.line_item_total_amount) AS revenue\nFROM order_detail od\nJOIN order_header oh ON oh.order_id = od.order_id\nGROUP BY od.catalog_sku\nORDER BY revenue DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List the positions for any order placed by a account holder with family name 'Perez' where the stage is 'shipped'.", "output": "SELECT c.FNAME, c.SURNAME, oh.oe_number, od.line_number, od.catalog_sku, od.quantity, od.unit_price\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.SURNAME = 'Perez' AND oh.order_status = 'shipped'\nORDER BY oh.order_entry_date DESC, od.line_number;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every purchase that includes the item code 'SKU-TR6SNG'. Return the buyer name, the order code, and when it was order date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-TR6SNG'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show sale for the customer with email 'zntzzcrg@example.com' between 2024-03-25 and 2024-06-16.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'zntzzcrg@example.com' AND oh.order_entry_date BETWEEN '2024-03-25' AND '2024-06-16'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 5 buyer by checkout total between 2025-01-04 and 2025-07-04?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2025-01-04' AND '2025-07-04'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 5;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2023-10-19 and 2024-04-10.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2023-10-19' AND '2024-04-10'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2025-10-05 and 2025-11-01.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2025-10-05' AND '2025-11-01'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every purchase that includes the item code 'SKU-RDIHSA'. Return the buyer name, the reference id, and when it was date of purchase.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-RDIHSA'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2024-10-24 and 2024-12-08.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2024-10-24' AND '2024-12-08'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show transaction for the customer with email 'pxuwwyjy@sample.io' between 2023-07-26 and 2023-09-17.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'pxuwwyjy@sample.io' AND oh.order_entry_date BETWEEN '2023-07-26' AND '2023-09-17'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show all purchases for Chloe Clark that include item 'SKU-XRLZU6' with at least 2 quantity.", "output": "SELECT oh.oe_number, oh.order_entry_date, od.catalog_sku, od.quantity\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE c.FNAME = 'Chloe' AND c.SURNAME = 'Clark' AND od.catalog_sku = 'SKU-XRLZU6' AND od.quantity >= 2\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 4 purchase overall. Show name, contact email, and how many order.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 4\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List first-time purchasers whose very first checkout happened between 2025-03-12 and 2025-09-03.", "output": "WITH first_orders AS (\n  SELECT customer_id, MIN(order_entry_date) AS first_date\n  FROM order_header\n  GROUP BY customer_id\n)\nSELECT c.FNAME, c.SURNAME, c.email, f.first_date\nFROM first_orders f\nJOIN buyers c ON c.customer_id = f.customer_id\nWHERE f.first_date BETWEEN '2025-03-12' AND '2025-09-03'\nORDER BY f.first_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show purchase for the buyer with contact email 'pxzfoydt@mail.test' from 2024-12-11 and 2025-01-30.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'pxzfoydt@mail.test' AND oh.order_entry_date BETWEEN '2024-12-11' AND '2025-01-30'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List client who made more than 4 purchase overall. Show name, contact email, and how many order.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 4\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every sale that includes the item code 'SKU-2ZBPPF'. Return the buyer name, the invoice number, and when it was order date.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-2ZBPPF'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List sale with total due above 100 and state 'on hold' between 2024-04-06 and 2024-05-03. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 100 AND oh.order_status = 'on hold' AND oh.order_entry_date BETWEEN '2024-04-06' AND '2024-05-03'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show sale for the buyer with mail address 'agcixeby@example.com' between 2024-11-23 and 2025-02-17.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'agcixeby@example.com' AND oh.order_entry_date BETWEEN '2024-11-23' AND '2025-02-17'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List transaction with cart total above 1000 and state 'processing' between 2023-04-20 and 2023-05-09. Include client name and code.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_total_amount, oh.order_entry_date\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE oh.order_total_amount > 1000 AND oh.order_status = 'processing' AND oh.order_entry_date BETWEEN '2023-04-20' AND '2023-05-09'\nORDER BY oh.order_total_amount DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each item code, show the average per-item price paid, descending by the average.", "output": "SELECT od.catalog_sku, AVG(od.unit_price)::numeric(10,2) AS avg_price\nFROM order_detail od\nGROUP BY od.catalog_sku\nORDER BY avg_price DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List person who made more than 6 transaction overall. Show name, contact email, and how many transaction.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 6\nORDER BY order_count DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every transaction that includes the item code 'SKU-DOTRBA'. Return the buyer name, the ticket id, and when it was checkout day.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-DOTRBA'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Who are the top 3 customer by spend between 2024-02-28 and 2024-05-11?", "output": "SELECT c.FNAME, c.SURNAME, c.email, SUM(oh.order_total_amount) AS total_spend\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nWHERE oh.order_entry_date BETWEEN '2024-02-28' AND '2024-05-11'\nGROUP BY c.FNAME, c.SURNAME, c.email\nORDER BY total_spend DESC\nLIMIT 3;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Find every transaction that includes the item code 'SKU-ORXDTG'. Return the buyer name, the receipt number, and when it was checkout day.", "output": "SELECT c.FNAME || ' ' || c.SURNAME AS customer_name, oh.oe_number, oh.order_entry_date\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN order_detail od ON od.order_id = oh.order_id\nWHERE od.catalog_sku = 'SKU-ORXDTG'\nORDER BY oh.order_entry_date DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "Show purchase for the person with email 'lgvodscr@acme.co' from 2025-04-27 and 2025-08-11.", "output": "SELECT oh.oe_number, oh.order_entry_date, oh.order_status, oh.order_total_amount\nFROM order_header oh\nJOIN buyers c ON c.customer_id = oh.customer_id\nWHERE c.email = 'lgvodscr@acme.co' AND oh.order_entry_date BETWEEN '2025-04-27' AND '2025-08-11'\nORDER BY oh.order_entry_date;"}
{"instruction": "Write a SQL query based on the following request.", "input": "For each client, compute the average number of line items per purchase. Return contact email and the average count, highest first.", "output": "WITH lines AS (\n  SELECT oh.order_id, COUNT(*) AS cnt\n  FROM order_detail od JOIN order_header oh ON od.order_id = oh.order_id\n  GROUP BY oh.order_id\n)\nSELECT c.email, AVG(l.cnt)::numeric(10,2) AS avg_lines\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nJOIN lines l ON l.order_id = oh.order_id\nGROUP BY c.email\nORDER BY avg_lines DESC;"}
{"instruction": "Write a SQL query based on the following request.", "input": "List account holder who made more than 6 purchase overall. Show name, mail address, and how many transaction.", "output": "SELECT c.FNAME, c.SURNAME, c.email, COUNT(*) AS order_count\nFROM buyers c\nJOIN order_header oh ON oh.customer_id = c.customer_id\nGROUP BY c.FNAME, c.SURNAME, c.email\nHAVING COUNT(*) > 6\nORDER BY order_count DESC;"}
